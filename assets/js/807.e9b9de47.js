(self.webpackChunkts_test=self.webpackChunkts_test||[]).push([[807],{8512:(e,t,r)=>{"use strict";r.d(t,{d:()=>n});const a=class{constructor(e){this.Type=a.Type,this.Value=e}DisplayStr(){return"#"+(this.Value?"t":"f")}static isTrue(e){return e.Type!==a.Type||e.Value}equal(e){return e.Type===a.Type&&this.Value===e.Value}Copy(){return new a(this.Value)}};let n=a;n.Type="MyBool"},3975:(e,t,r)=>{"use strict";r.d(t,{uG:()=>a,xJ:()=>n,Zz:()=>s,th:()=>l});class a{static MakeFromFloat(e){let t=new a;if(Number.isInteger(e))t.Numerator=e,t.Denominator=1;else{let r=e.toString().split(".");t.Denominator=Math.pow(10,r[1].length),t.Numerator=t.Denominator*Number.parseInt(r[0])+Number.parseInt(r[1]),t.reduce()}return t}static MakeFromInteger(e,t){let r=new a;return r.Numerator=e,r.Denominator=t,r.reduce(),r}static MakeFromRational(e){let t=new a;return Object.assign(t,e),t}toNumber(){return this.Numerator/this.Denominator}DisplayStr(){return 1===this.Denominator||0===this.Numerator?`${this.Numerator}`:`${this.Numerator}/${this.Denominator}`}reduce(){if(0===this.Numerator)return void(this.Denominator=1);let e=l(this.Numerator,this.Denominator);this.Denominator/=e,this.Numerator/=e,this.Denominator<0&&(this.Denominator*=-1,this.Numerator*=-1)}plus(e){this.Numerator*=e.Denominator,this.Numerator+=e.Numerator*this.Denominator,this.Denominator*=e.Denominator,this.reduce()}minus(e){this.Numerator*=e.Denominator,this.Numerator-=e.Numerator*this.Denominator,this.Denominator*=e.Denominator,this.reduce()}times(e){this.Numerator*=e.Numerator,this.Denominator*=e.Denominator,this.reduce()}div(e){this.Numerator*=e.Denominator,this.Denominator*=e.Numerator,this.reduce()}equal(e){return this.Numerator===e.Numerator&&this.Denominator===e.Denominator}}class n{static MakeFromFloat(e,t){let r=new n;return r.Value=e?a.MakeFromFloat(t):t,r}static MakeFromRational(e){let t=new n;return t.Value=e,t}static MakeFromReal(e,t){let r=new n;return e?t.Value instanceof a?r.Value=a.MakeFromRational(t.Value):r.Value=a.MakeFromFloat(t.Value):t.Value instanceof a?r.Value=t.Value.toNumber():r.Value=t.Value,r}DisplayStr(){return this.Value instanceof a?this.Value.DisplayStr():this.Value.toString()}Zero(){return 0===this.toNumber()}toNumber(){return this.Value instanceof a?this.Value.toNumber():this.Value}toInt(){return Number.parseInt(this.toNumber().toString())}plus(e){this.Value instanceof a?e.Value instanceof a?this.Value.plus(e.Value):this.Value=this.Value.toNumber()+e.toNumber():this.Value=this.Value+e.toNumber()}minus(e){this.Value instanceof a?e.Value instanceof a?this.Value.minus(e.Value):this.Value=this.Value.toNumber()-e.toNumber():this.Value=this.Value-e.toNumber()}equalS(e){return this.Value instanceof a?e.Value instanceof a?this.Value.equal(e.Value):this.Value.toNumber()===e.toNumber():this.Value===e.toNumber()}equal(e){return this.Value instanceof a?e.Value instanceof a&&this.Value.equal(e.Value):!(e.Value instanceof a)&&this.Value===e.toNumber()}times(e){this.Value instanceof a?e.Value instanceof a?this.Value.times(e.Value):this.Value=this.Value.toNumber()*e.toNumber():this.Value=this.Value*e.toNumber()}div(e){this.Value instanceof a?e.Value instanceof a?this.Value.div(e.Value):this.Value=this.Value.toNumber()/e.toNumber():this.Value=this.Value/e.toNumber()}}const i=class{constructor(){this.Type=i.Type,this.RealPart=n.MakeFromRational(a.MakeFromInteger(0,1)),this.UnRealPart=n.MakeFromRational(a.MakeFromInteger(0,1))}DisplayStr(){if(this.UnRealPart.Zero())return this.RealPart.DisplayStr();{let e=this.UnRealPart.DisplayStr();return`${this.RealPart.DisplayStr()}${"-"===e[0]?e:`+${e}`}i`}}plus(e){this.RealPart.plus(e.RealPart),this.UnRealPart.plus(e.UnRealPart)}minus(e){this.RealPart.minus(e.RealPart),this.UnRealPart.minus(e.UnRealPart)}equal(e){return e instanceof i&&this.RealPart.equal(e.RealPart)&&this.UnRealPart.equal(e.UnRealPart)}equalS(e){return this.RealPart.equalS(e.RealPart)&&this.UnRealPart.equalS(e.UnRealPart)}times(e){let t=new i;t.plus(this),t.RealPart.times(e.RealPart),t.UnRealPart.times(e.UnRealPart),t.RealPart.minus(t.UnRealPart),this.RealPart.times(e.UnRealPart),this.UnRealPart.times(e.RealPart),this.UnRealPart.plus(this.RealPart),this.RealPart=t.RealPart}div(e){let t=n.MakeFromFloat(!0,0);t.plus(e.RealPart),t.times(e.RealPart);let r=n.MakeFromFloat(!0,0);r.plus(e.UnRealPart),r.times(e.UnRealPart),t.plus(r);let a=new i;a.plus(this),a.RealPart.times(e.RealPart),a.UnRealPart.times(e.UnRealPart),a.RealPart.plus(a.UnRealPart),this.RealPart.times(e.UnRealPart),this.UnRealPart.times(e.RealPart),this.UnRealPart.minus(this.RealPart),this.RealPart=a.RealPart,this.RealPart.div(t),this.UnRealPart.div(t)}less(e){return this.RealPart.toNumber()<e.RealPart.toNumber()||this.RealPart.toNumber()===e.RealPart.toNumber()&&this.UnRealPart.toNumber()<e.UnRealPart.toNumber()}Copy(){let e=new i;return e.RealPart=this.RealPart,e.UnRealPart=this.UnRealPart,e}};let s=i;s.Type="Complex";const l=(e,t)=>0==e?t:l(t%e,e)},4148:(e,t,r)=>{"use strict";r.d(t,{i:()=>n});const a=class{constructor(e,t){this.Type=a.Type,this.first=e,this.second=t}DisplayStr(){let e="(";return void 0!==this.first&&(e+=this.first.DisplayStr()),void 0===this.second?e+=")":this.second instanceof a?e+=" "+this.second.DisplayStr().slice(1):e+=" "+this.second.DisplayStr()+")",e}car(){return this.first}cdr(){return this.second}cadr(e){let t=this;for(let r=e.length-1;r>=0;r--){if(t.Type!==a.Type)throw new Error(`Cons cadr error: not a pair after ${e.slice(r)}`);if("a"===e[r])t=t.car();else{if("d"!==e[r])throw new Error(`Cons cadr error: unexpected char ${e[r]}`);t=t.cdr()}}return t}toArray(){let e=new Array;return a.null(this)||(e.push(this.car()),void 0!==this.second&&(this.second instanceof a?e.push(...this.second.toArray()):e.push(this.second))),e}static List(...e){return 0===e.length?a.nil():new a(e[0],a.List(...e.splice(1)))}static nil(){return new a(void 0,void 0)}equal(e){return e.Type===a.Type&&this.first===e.first&&this.second===e.second}static null(e){return void 0===e||void 0===e.first&&void 0===e.second}isList(){return!!a.null(this)||this.second.Type===a.Type&&this.second.isList()}Copy(){let e,t;return void 0!==this.first&&(e=this.first.Copy()),void 0!==this.second&&(t=this.second.Copy()),new a(e,t)}};let n=a;n.Type="Cons"},3190:(e,t,r)=>{"use strict";r.d(t,{g:()=>n});const a=class{constructor(e,t,r,n){this.Type=a.Type,this.primitive=e,this.parameters=t,this.body=r,this.env=n}DisplayStr(){return this.primitive?"basic_procedure":`(lambda (${this.parameters.map((e=>e.Value)).join(" ")}) ${this.body.DisplayStr()}`}equal(e){return this===e}Copy(){return new a(this.primitive,void 0!==this.parameters?this.parameters.map((e=>e.Copy())):this.parameters,this.primitive?this.body:this.body.Copy(),this.env)}};let n=a;n.Type="procedure"},2813:(e,t,r)=>{"use strict";r.d(t,{i:()=>n,x:()=>s});const a=class{constructor(){this.Type=a.Type}DisplayStr(){return`'${this.Value.DisplayStr()}`}equal(e){return e.Type===a.Type&&this.Value.equal(e.Value)}Copy(){let e=new a;return e.Value=this.Value.Copy(),e}};let n=a;n.Type="Quotation";const i=class{constructor(e){this.Type=i.Type,this.Value=e}DisplayStr(){return`${this.Value}`}equal(e){return e.Type===i.Type&&this.Value===e.Value}Copy(){return new i(this.Value)}};let s=i;s.Type="Identifier"},1500:(e,t,r)=>{"use strict";r.d(t,{A:()=>n,x:()=>s});const a=class{constructor(){this.Type=a.Type}DisplayStr(){return`"${this.Value}"`}equal(e){return e.Type===a.Type&&this.Value===e.Value}Copy(){let e=new a;return e.Value=this.Value,e}};let n=a;n.Type="MyString";const i=class{constructor(e){this.Type=i.Type,this.Value=e}DisplayStr(){return`#\\${this.Value}`}equal(e){return e.Type===i.Type&&this.Value===e.Value}Copy(){return new i(this.Value)}};let s=i;s.Type="MyChar"},7574:(e,t,r)=>{"use strict";r.d(t,{G:()=>p,n:()=>f});var a=r(8512),n=r(3975),i=r(4148),s=r(3190),l=r(2813),o=r(1500);class u{constructor(){this.map_=new Map,this.parent_=void 0}Get(e){if(this.map_.has(e))return this.map_.get(e);if(void 0===this.parent_)throw new Error(`undeclare ${e}`);return this.parent_.Get(e)}Set(e,t){this.map_.set(e,t)}MakeChild(){let e=new u;return e.setParent(this),e}Parent(){return this.parent_}setParent(e){this.parent_=e}}var c=r(542),d=r(5538);function p(e,t){let r=e.Copy();if(e.primitive){let r=e.body(t.toArray());return c.r.getInstance().replace(e,r),r}return c.r.getInstance().replace(e,r.body),(0,d.C)(e,function(e,t,r){let a=e.MakeChild();for(let e=0;e<t.length;e++){const n=t[e];if("."===n.Value){if(e!==t.length-2)throw new Error("produce: unexpected identifier dot");break}if(i.i.null(r))throw new Error("produce: the expected number of arguments does not match the given number");a.Set(n.Value,r.car()),r=r.cdr()}if(t.length>=2&&"."===t[t.length-2].Value&&(a.Set(t[-1].Value,r),r=void 0),!i.i.null(r))throw new Error("produce: the expected number of arguments does not match the given number");return a}(r.env,r.parameters,t))}function h(e){return new s.g(!0,void 0,(t=>{if(1!=t.length)throw new Error(`c${e}r : expected 1 arguments`);return t[0].cadr(e)}),void 0)}function f(){let e=new u;e.Set("+",new s.g(!0,void 0,(e=>{let t=new n.Zz;for(const r of e)t.plus(r);return t}),void 0)),e.Set("-",new s.g(!0,void 0,(e=>{if(e.length<1)throw new Error("- : expected at least 1 argument");let t=new n.Zz;e.length>1&&(t.plus(e[0]),t.plus(e[0]));for(const r of e)t.minus(r);return t}),void 0)),e.Set("*",new s.g(!0,void 0,(e=>{let t=new n.Zz;t.RealPart=n.xJ.MakeFromFloat(!0,1);for(const r of e)t.times(r);return t}),void 0)),e.Set("/",new s.g(!0,void 0,(e=>{if(e.length<1)throw new Error("/ : expected at least 1 argument");let t=new n.Zz;t.RealPart=n.xJ.MakeFromFloat(!0,1),e.length>1&&(t.times(e[0]),t.times(e[0]));for(const r of e)t.div(r);return t}),void 0)),e.Set("=",new s.g(!0,void 0,(e=>{if(e.length<1)throw new Error("= : expected at least 1 argument");let t=e[0];for(const r of e)if(!t.equal(r))return new a.d(!1);return new a.d(!0)}),void 0)),e.Set("<",new s.g(!0,void 0,(e=>{if(e.length<1)throw new Error("< : expected at least 1 argument");let t=e[0];for(let r=1;r<e.length;r++){const n=e[r];if(!t.less(n))return new a.d(!1);t=n}return new a.d(!0)}),void 0)),e.Set("<=",new s.g(!0,void 0,(e=>{if(e.length<1)throw new Error("<= : expected at least 1 argument");let t=e[0];for(let r=1;r<e.length;r++){const n=e[r];if(!t.less(n)&&!t.equal(n))return new a.d(!1);t=n}return new a.d(!0)}),void 0)),e.Set(">",new s.g(!0,void 0,(e=>{if(e.length<1)throw new Error("> : expected at least 1 argument");let t=e[0];for(let r=1;r<e.length;r++){const n=e[r];if(t.less(n)||t.equal(n))return new a.d(!1);t=n}return new a.d(!0)}),void 0)),e.Set(">=",new s.g(!0,void 0,(e=>{if(e.length<1)throw new Error(">= : expected at least 1 argument");let t=e[0];for(let r=1;r<e.length;r++){const n=e[r];if(t.less(n))return new a.d(!1);t=n}return new a.d(!0)}),void 0)),e.Set("eq?",new s.g(!0,void 0,(e=>{if(2!=e.length)throw new Error("eq? : expected 2 arguments");return void 0===e[0]||void 0===e[1]?new a.d(e[1]===e[0]):new a.d(e[1].equal(e[0]))}),void 0)),e.Set("equal?",new s.g(!0,void 0,(e=>{if(2!=e.length)throw new Error("eq? : expected 2 arguments");return void 0===e[0]||void 0===e[1]?new a.d(e[1]===e[0]):new a.d(e[1].DisplayStr()===e[0].DisplayStr())}),void 0)),e.Set("nil",i.i.nil()),e.Set("number?",new s.g(!0,void 0,(e=>{if(1!=e.length)throw new Error("number? : expected 1 arguments");return new a.d(void 0!==e[0]&&e[0].Type===n.Zz.Type)}),void 0)),e.Set("complex?",new s.g(!0,void 0,(e=>{if(1!=e.length)throw new Error("complex? : expected 1 arguments");return new a.d(void 0!==e[0]&&e[0].Type===n.Zz.Type)}),void 0)),e.Set("real?",new s.g(!0,void 0,(e=>{if(1!=e.length)throw new Error("complex? : expected 1 arguments");return new a.d(void 0!==e[0]&&e[0].Type===n.Zz.Type&&e[0].UnRealPart.Zero())}),void 0)),e.Set("rational?",new s.g(!0,void 0,(e=>{if(1!=e.length)throw new Error("complex? : expected 1 arguments");return new a.d(void 0!==e[0]&&e[0].Type===n.Zz.Type&&e[0].UnRealPart.Zero()&&"number"!=typeof e[0].RealPart.Value)}),void 0)),e.Set("integer?",new s.g(!0,void 0,(e=>{if(1!=e.length)throw new Error("complex? : expected 1 arguments");if(void 0!==e[0]&&e[0].Type===n.Zz.Type&&e[0].UnRealPart.Zero()){if("number"==typeof e[0].RealPart.Value){let t=e[0].RealPart.Value;return new a.d(Number.isInteger(t))}return new a.d(1===e[0].RealPart.Value.Denominator)}return new a.d(!1)}),void 0)),e.Set("quotient",new s.g(!0,void 0,(e=>{if(2!=e.length)throw new Error("quotient : expected 2 arguments");let t=e[0].RealPart.toInt(),r=e[1].RealPart.toInt(),a=new n.Zz;return t-=t%r,a.RealPart=n.xJ.MakeFromRational(n.uG.MakeFromInteger(t/r,1)),a}),void 0)),e.Set("remainder",new s.g(!0,void 0,(e=>{if(2!=e.length)throw new Error("remainder : expected 2 arguments");let t=e[0].RealPart.toInt(),r=e[1].RealPart.toInt(),a=new n.Zz;return a.RealPart=n.xJ.MakeFromRational(n.uG.MakeFromInteger(t%r,1)),a}),void 0)),e.Set("gcd",new s.g(!0,void 0,(e=>{if(2!=e.length)throw new Error("gcd : expected 2 arguments");let t=e[0].RealPart.toInt(),r=e[1].RealPart.toInt(),a=new n.Zz;return a.RealPart=n.xJ.MakeFromRational(n.uG.MakeFromInteger((0,n.th)(t,r),1)),a}),void 0)),e.Set("lcm",new s.g(!0,void 0,(e=>{if(2!=e.length)throw new Error("lcm : expected 2 arguments");let t=e[0].RealPart.toInt(),r=e[1].RealPart.toInt(),a=new n.Zz;return a.RealPart=n.xJ.MakeFromRational(n.uG.MakeFromInteger(t/(0,n.th)(t,r)*r,1)),a}),void 0)),e.Set("not",new s.g(!0,void 0,(e=>{if(1!=e.length)throw new Error("not : expected 2 arguments");return new a.d(e[0].Type===a.d.Type&&!e[0].Value)}),void 0)),e.Set("pair?",new s.g(!0,void 0,(e=>{if(1!=e.length)throw new Error("pair? : expected 1 arguments");return new a.d(e[0].Type===i.i.Type)}),void 0)),e.Set("cons",new s.g(!0,void 0,(e=>{if(2!=e.length)throw new Error("cons : expected 2 arguments");return new i.i(e[0],e[1])}),void 0)),e.Set("car",new s.g(!0,void 0,(e=>{if(1!=e.length)throw new Error("car : expected 1 arguments");return e[0].car()}),void 0)),e.Set("cdr",new s.g(!0,void 0,(e=>{if(1!=e.length)throw new Error("cdr : expected 1 arguments");return e[0].cdr()}),void 0)),e.Set("null?",new s.g(!0,void 0,(e=>{if(1!=e.length)throw new Error("cdr : expected 1 arguments");return new a.d(i.i.null(e[0]))}),void 0)),e.Set("list?",new s.g(!0,void 0,(e=>{if(1!=e.length)throw new Error("list? : expected 1 arguments");return new a.d(e[0].isList())}),void 0)),e.Set("list",new s.g(!0,void 0,(e=>{if(e.length<1)throw new Error("list : expected at least 1 arguments");return i.i.List(...e)}),void 0)),e.Set("symbol?",new s.g(!0,void 0,(e=>{if(1!=e.length)throw new Error("symbol? : expected 1 arguments");return new a.d(e[0].Type===l.x.Type)}),void 0)),e.Set("display",new s.g(!0,void 0,(e=>{for(const t of e)t instanceof o.A||t instanceof o.x?c.r.getInstance().display(t.Value):c.r.getInstance().display(t.DisplayStr())}),void 0)),e.Set("newline",new s.g(!0,void 0,(e=>{c.r.getInstance().display("\n")}),void 0));let t=t=>{for(let r=0;r<1<<t;r++){let a="";for(let e=0;e<t;e++)a+=0==(r>>e&1)?"a":"d";let n=`c${a}r`;e.Set(n,h(a))}};return t(2),t(3),t(4),e}},5538:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c,C:()=>d});var a=r(8512),n=r(4148),i=r(3190),s=r(2813),l=r(1489),o=r(542),u=r(7574);function c(e,t){if(l.u0(e))return e;if(l.VD(e)){let r=t.Get(e.Value);return void 0!==r&&r.Type!==i.g.Type&&o.r.getInstance().replace(e,r),r}if(l.xI(e))return e.Value;if(!l.DF(e)){if(l.zB(e))return function(e,t){let r=c(function(e){return e.cadr("ad")}(e),t);if(a.d.isTrue(r)){let r=function(e){return e.cadr("add")}(e);return o.r.getInstance().replace(e,r),c(e,t)}{let r=function(e){let t=e.cadr("ddd");if(!n.i.null(t)){if(!n.i.null(t.cdr()))throw new Error("if error: multiple expression");return t.car()}}(e);if(void 0!==r||r.Type!==n.i.Type||!n.i.null(r))return o.r.getInstance().replace(e,r),c(e,t)}}(e,t);if(l.D8(e))return function(e,t,r){return new i.g(!1,e.toArray(),t,r)}(e.cadr("ad"),e.cadr("dd"),t);if(l.a7(e))return o.r.getInstance().replace(e,e.cdr()),d(e,t);if(l.wV(e)){let r=m(e.cdr());return o.r.getInstance().replace(e,r),c(e,t)}if(l.Rj(e))return function(e,t){let r=e.cdr(),a=r.car(),i=r.cdr(),s=new Array,l=new Array;for(;!n.i.null(a);){let e=a.car();if(s.push(e.car()),l.push(e.cadr("ad")),!n.i.null(e.cadr("dd")))throw new Error("let : multiple expression");a=a.cdr()}let d=c(h(n.i.List(...s),i),t),p=n.i.List(...l);return o.r.getInstance().replace(e,n.i.List(d,p)),p=g(p,t),o.r.getInstance().replace(e,d,!1),(0,u.G)(e,p)}(e,t);if(l.Is(e))return function(e,t){let r=e.cdr();if(n.i.null(r))return o.r.getInstance().replace(e,new a.d(!0)),new a.d(!0);let i=r.car(),u=r.cdr();if(n.i.null(u)){o.r.getInstance().replace(e,i);let r=l.u0(e),a=c(e,t);return r||o.r.getInstance().replace(e,a),a}let d=p(i,new n.i(new s.x("and"),u),new a.d(!1));return o.r.getInstance().replace(e,d),c(e,t)}(e,t);if(l.vV(e))return function(e,t){let r=e.cdr();if(n.i.null(r))return o.r.getInstance().replace(e,new a.d(!1)),new a.d(!1);let i=r.car(),u=r.cdr();if(n.i.null(u)){o.r.getInstance().replace(e,i);let r=l.u0(e),a=c(e,t);return r||o.r.getInstance().replace(e,a),a}i=c(i,t);let d=p(i,i,new n.i(new s.x("or"),u));return o.r.getInstance().replace(e,d),c(e,t)}(e,t);if(l.wU(e)){let r=c(e.car(),t),a=g(e.cdr(),t);return o.r.getInstance().replace(e,r,!1),(0,u.G)(e,a)}throw new Error("Unknown expression type")}!function(e,t){let r=function(e){try{let t=e.cadr("ad");return t.Type===s.x.Type?t.Value:e.cadr("aad").Value}catch(e){throw new Error("definition error: miss definition-variable")}}(e),a=c(function(e){let t=0;try{if(e.cadr("ad").Type===s.x.Type){let r=e.cadr("dd");if(!n.i.null(r.cdr()))throw t=1,new Error;return r.car()}return h(e.cadr("dad"),e.cadr("dd"))}catch(e){throw 1===t?new Error("definition error: multiple definition-value"):new Error("definition error: miss definition-value")}}(e),t);o.r.getInstance().replace(e,n.i.List(new s.x("define"),new s.x(r),a)),t.Set(r,a)}(e,t)}function d(e,t){return n.i.null(e.cdr())?(o.r.getInstance().replace(e,e.car()),c(e,t)):(o.r.getInstance().replace(e.car(),c(e.car(),t)),o.r.getInstance().replace(e,e.cdr()),d(e,t))}function p(e,t,r){return void 0===r||r.Type===n.i.Type&&n.i.null(r)?n.i.List(new s.x("if"),e,t):n.i.List(new s.x("if"),e,t,r)}function h(e,t){return new n.i(new s.x("lambda"),new n.i(e,t))}function f(e){if(!n.i.null(e))return n.i.null(e.cdr())?e.car():new n.i(new s.x("begin"),e)}function m(e){if(n.i.null(e))return n.i.nil();let t=e.car(),r=e.cdr();if(l.Ni(t,"else")){if(!n.i.null(r))throw new Error("cond : else clause isn't last");return f(t.cdr())}return p(t.car(),f(t.cdr()),m(r))}function g(e,t){if(n.i.null(e))return n.i.nil();let r=e.car();return l.u0(r),r=c(r,t),new n.i(r,g(e.cdr(),t))}},1489:(e,t,r)=>{"use strict";r.d(t,{Qc:()=>u,u0:()=>c,VD:()=>d,xI:()=>p,Ni:()=>h,DF:()=>f,zB:()=>m,D8:()=>g,a7:()=>y,wV:()=>w,Rj:()=>R,Is:()=>V,vV:()=>x,wU:()=>T});var a=r(8512),n=r(3975),i=r(4148),s=r(2813),l=r(1500),o=r(1425);function u(e,t){let r,a;if(void 0===t){if(r=e.next(),r.done)return}else r=t;a=r.value;let n=()=>{if(r=e.next(),r.done&&a.Type!==o.yV.Type)throw new Error("Datum parse error: unexpected EOF");a=r.value};for(;a.Type===o.yV.Type;)if(n(),r.done)return;if(a.Type===o.Lu.Type){let t=new s.i;return t.Value=u(e),t}if(a.Type===o.l7.Type){let t=new Array;for(;n(),o.ty.Type!==a.Type;){let a=u(e,r);t.push(a)}for(let e=0;e<t.length;e++)if(t[e].Type===s.x.Type&&"."===t[e].Value&&(0===e||e!==t.length-2))throw new Error(" illegal use of `.`");return i.i.List(...t)}if(a.Type===o.PY.Type||a.Type===o.Rs.Type||a.Type===o.pQ.Type||a.Type===o.Uo.Type||a.Type===o.Vn.Type)return a.Value;throw console.log(a),new Error("Datum parse error: unexpected token type")}function c(e){return e.Type===l.x.Type||e.Type===l.A.Type||e.Type===n.Zz.Type||e.Type===a.d.Type}function d(e){return e.Type===s.x.Type}function p(e){return e.Type===s.i.Type}function h(e,t){if(e.Type===i.i.Type){let r=e.car();return r.Type===s.x.Type&&r.Value===t}return!1}function f(e){return h(e,"define")}function m(e){return h(e,"if")}function g(e){return h(e,"lambda")}function y(e){return h(e,"begin")}function w(e){return h(e,"cond")}function R(e){return h(e,"let")}function V(e){return h(e,"and")}function x(e){return h(e,"or")}function T(e){return e.Type===i.i.Type}},542:(e,t,r)=>{"use strict";var a,n;r.d(t,{r:()=>y,K:()=>w}),(n=a||(a={}))[n.Initial=1]="Initial",n[n.BracketsLeftRound=2]="BracketsLeftRound",n[n.BracketsRightRound=3]="BracketsRightRound",n[n.Comma=4]="Comma",n[n.Apostrophe=5]="Apostrophe",n[n.Dot=6]="Dot",n[n.Dot3=7]="Dot3",n[n.Comment=8]="Comment",n[n.StringBegin=9]="StringBegin",n[n.StringEscape=10]="StringEscape",n[n.Hash=11]="Hash",n[n.Boolean=12]="Boolean",n[n.CharBegin=13]="CharBegin",n[n.CharEscape=14]="CharEscape",n[n.Radix1=15]="Radix1",n[n.Radix2=16]="Radix2",n[n.Exactness1=17]="Exactness1",n[n.Exactness2=18]="Exactness2",n[n.Prefix=19]="Prefix",n[n.SignInit=20]="SignInit",n[n.Sign=21]="Sign",n[n.UrealR=22]="UrealR",n[n.UintegerRB=23]="UintegerRB",n[n.UintegerRE=24]="UintegerRE",n[n.DecimalB=25]="DecimalB",n[n.DecimalE=26]="DecimalE",n[n.SuffixB=27]="SuffixB",n[n.SuffixE=28]="SuffixE",n[n.SuffixNum=29]="SuffixNum",n[n.SuffixSign=30]="SuffixSign",n[n.Complex=31]="Complex",n[n.IdInit=32]="IdInit",n[n.Fail=33]="Fail",n[n.End=34]="End",n[n.Final=35]="Final";var i=r(1425);const s=["!","$","%","&","*","/",":","<","=",">","?","^","_","~"],l=["+","-",".","@"],o=new Map([[2,["0","1"]],[8,["0","1","2","3","4","5","6","7"]],[10,["0","1","2","3","4","5","6","7","8","9"]],[16,["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"]]]),u=[" ","\t","\n","(",")",'"',"\t",""],c=new Map([["a","a"],["b","\b"],["n","\n"],["r","\r"],["v","\v"],["\\","\\"],["'","'"],['"','"']]);function d(e,t){return void 0!==e.find((e=>e===t))}function p(e){return/^[a-zA-Z]$/.test(e)}function h(e){return p(e)||d(s,e)||d(o.get(10),e)||d(l,e)}function f(e){switch(e){case"":return a.Final;case" ":case"\t":case"\n":case"\r":return a.Initial;case"(":return a.BracketsLeftRound;case")":return a.BracketsRightRound;case";":return a.Comment;case",":return a.Comma;case".":return a.Dot;case"'":return a.Apostrophe;case'"':return a.StringBegin;case"#":return a.Hash;case"+":case"-":return a.Sign;default:return p(e)||d(s,e)?a.IdInit:d(o.get(10),e)?a.UrealR:a.Fail}}var m=r(1489),g=r(5538);class y{constructor(){}static getInstance(){return y.instance||(y.instance=new y),y.instance}subModel(e){this.cur_=e}subShow(){this.sub_&&void 0!==this.cur_&&(this.display_(this.cur_.DisplayStr()),this.display_("\n"))}display(e){this.display_(e)}replace(e,t,r=!0){void 0!==t&&(Object.assign(e,t),Object.setPrototypeOf(e,Object.getPrototypeOf(t)),r&&this.subShow())}setDisplay(e){this.display_=e}setSub(e){this.sub_=e}}function w(e,t,r,n){let s=function*(e){let t,r,n=function*(e){for(const t of e)yield t}(e),s=a.Initial,l=1,p=1,m=()=>{s!==a.Fail&&s!==a.Final&&(t=n.next(),t.done||("\n"==t.value?(l++,p=1):p++))};for(m();;){let e=t.done?"":t.value;switch(s){case a.Initial:s=f(e),s===a.Sign||s===a.IdInit?r=new i.Vn(e):s===a.UrealR&&(r=new i.Rs,r.appendValue(e)),m();break;case a.BracketsLeftRound:r=new i.l7,s=a.End;break;case a.BracketsRightRound:r=new i.ty,s=a.End;break;case a.Comma:r=new i.Um,s=a.End;break;case a.Dot:d(u,e)?(r=new i.VG,s=a.End):"."===e?(s=a.Dot3,m()):s=a.Fail;break;case a.Dot3:"."===e?(m(),r=new i.mi,s=a.End):s=a.Fail;break;case a.Apostrophe:r=new i.Lu,s=a.End;break;case a.Comment:void 0===r&&(r=new i.yV("")),"\n"===e||""===e?s=a.End:r.Value+=e,m();break;case a.StringBegin:void 0===r&&(r=new i.Uo("")),"\\"===e?s=a.StringEscape:'"'===e?s=a.End:r.Value.Value+=e,m();break;case a.StringEscape:c.has(e)?(r.Value.Value+=c.get(e),m(),s=a.StringBegin):s=a.Fail;break;case a.Hash:switch(e){case"t":r=new i.PY(!0),s=a.Boolean;break;case"f":r=new i.PY(!1),s=a.Boolean;break;case"\\":r=new i.pQ,s=a.CharBegin;break;case"e":case"i":r=new i.Rs,s=a.Exactness1,r.Exactness="i"===e?2:1;break;case"b":case"o":case"d":case"x":r=new i.Rs,s=a.Radix1,"b"===e?r.Radix=2:"o"===e?r.Radix=8:"x"===e&&(r.Radix=16);break;default:s=a.Fail}m();break;case a.Boolean:s=d(u,e)?a.End:a.Fail;break;case a.CharBegin:r.Value=e,m(),s=d(u,e)?a.End:"s"===e||"n"===e?a.CharEscape:a.Fail;break;case a.CharEscape:const n="s"===r.Value?"pace":"ewline";for(const r of n){if(e!==r){s=a.Fail;break}m(),e=t.done?"":t.value}d(u,e)&&(s=a.Fail),s!==a.Fail&&(r.Value="s"===r.Value?" ":"\n",s=a.End);break;case a.Radix1:switch(e){case"#":s=a.Radix2;break;case"+":case"-":"-"===e&&r.setSign(-1),s=a.SignInit;break;default:d(o.get(r.Radix),e)?(r.appendValue(e),s=a.UrealR):s=a.Fail}m();break;case a.Radix2:switch(e){case"e":case"i":s=a.Prefix,r.Exactness="i"===e?2:1;break;default:s=a.Fail}break;case a.Exactness1:switch(e){case"#":s=a.Exactness2;break;case"+":case"-":"-"===e&&r.setSign(-1),s=a.SignInit;break;default:d(o.get(r.Radix),e)?(r.appendValue(e),s=a.UrealR):s=a.Fail}m();break;case a.Exactness2:switch(e){case"b":case"o":case"d":case"x":s=a.Prefix,"b"===e?r.Radix=2:"o"===e?r.Radix=8:"x"===e&&(r.Radix=16);break;default:s=a.Fail}break;case a.Prefix:switch(e){case"+":case"-":"-"===e&&r.setSign(-1),s=a.SignInit;break;default:d(o.get(r.Radix),e)?(r.appendValue(e),s=a.UrealR):s=a.Fail}m();break;case a.SignInit:d(o.get(r.Radix),e)?(r.appendValue(e),s=a.UrealR,m()):s=a.Fail;break;case a.Sign:if(d(u,e))s=a.End;else if(d(o.get(10),e)){let t=r.Value;r=new i.Rs,"-"===t.Value&&r.setSign(-1),r.appendValue(e),s=a.UrealR,m()}else s=a.Fail;break;case a.UrealR:d(u,e)?s=a.End:(d(o.get(r.Radix),e)?(r.appendValue(e),s=a.UrealR):"/"===e?(r.appendValue(e),s=a.UintegerRB):"+"===e||"-"===e||"@"===e?0===r.Part?(r.Part=1,"-"===e&&r.setSign(-1),s=a.Complex):s=a.Fail:"e"===e?10!==r.Radix?s=a.Fail:(r.appendValue(e),s=a.SuffixE):"."===e?10!==r.Radix?(r.appendValue(e),s=a.Fail):(r.appendValue(e),s=a.DecimalB):s="i"===e&&1===r.Part?a.End:a.Fail,m());break;case a.UintegerRB:d(o.get(r.Radix),e)?(r.appendValue(e),s=a.UintegerRE):s=a.Fail,m();break;case a.UintegerRE:d(u,e)?s=a.End:d(o.get(r.Radix),e)?(r.appendValue(e),s=a.UintegerRE,m()):"+"===e||"-"===e||"@"===e?0===r.Part?(r.Part=1,"-"===e&&r.setSign(-1),s=a.Complex,m()):s=a.Fail:"e"===e?10!==r.Radix?s=a.Fail:(r.appendValue(e),s=a.SuffixE,m()):"i"===e&&1===r.Part?(s=a.End,m()):s=a.Fail;break;case a.DecimalB:d(o.get(10),e)?(r.appendValue(e),s=a.UintegerRE):s=a.Fail,m();break;case a.DecimalE:d(u,e)?s=a.End:d(o.get(r.Radix),e)?(r.appendValue(e),s=a.UintegerRE,m()):0===r.Part?(r.Part=1,"-"===e&&r.setSign(-1),s=a.Complex,m()):s=a.Fail;break;case a.SuffixE:d(o.get(10),e)?(r.appendSuffix(e),s=a.SuffixNum):"+"===e||"-"===e?(r.appendSuffix(e),s=a.SuffixSign):s=a.Fail,m();break;case a.SuffixNum:d(u,e)?s=a.End:d(o.get(10),e)?(r.appendSuffix(e),s=a.SuffixNum,m()):0===r.Part?(r.Part=1,"-"===e&&r.setSign(-1),s=a.Complex,m()):s=a.Fail;break;case a.SuffixSign:d(o.get(10),e)?(r.appendSuffix(e),s=a.SuffixNum):s=a.Fail,m();break;case a.Complex:d(o.get(r.Radix),e)?(r.appendValue(e),s=a.UrealR):"i"===e?(r.appendValue("1"),s=a.End):s=a.Fail,m();break;case a.IdInit:d(u,e)?s=a.End:h(e)?(r.Value.Value+=e,s=a.IdInit,m()):s=a.Fail;break;case a.End:r.Type===i.Rs.Type&&r.generate(),yield r,r=void 0,s=a.Initial}if(s===a.Fail)throw new Error(`editor:${l}:${p}: read-syntax:`);if(s===a.Final)break}}(e);y.getInstance().setDisplay(t),y.getInstance().setSub(r);try{for(;;){let e=(0,m.Qc)(s);if(void 0===e)break;y.getInstance().subModel(e),y.getInstance().subShow();let t=(0,g.Z)(e,n);void 0!==t&&y.getInstance().display(t.DisplayStr()),y.getInstance().display("\n")}}catch(e){y.getInstance().display(e)}}},1425:(e,t,r)=>{"use strict";r.d(t,{l7:()=>o,ty:()=>c,Um:()=>p,Lu:()=>f,VG:()=>g,mi:()=>w,yV:()=>V,pQ:()=>T,Uo:()=>S,PY:()=>P,Rs:()=>F,Vn:()=>D});var a=r(8512),n=r(3975),i=r(2813),s=r(1500);const l=class{constructor(){this.Type=l.Type,this.Value="("}DisplayStr(){return this.Value}};let o=l;o.Type="BracketsLeftRound";const u=class{constructor(){this.Type=u.Type,this.Value=")"}DisplayStr(){return this.Value}};let c=u;c.Type="BracketsRightRound";const d=class{constructor(){this.Type=d.Type,this.Value=","}DisplayStr(){return this.Value}};let p=d;p.Type="Comma";const h=class{constructor(){this.Type=h.Type,this.Value="'"}DisplayStr(){return this.Value}};let f=h;f.Type="Apostrophe";const m=class{constructor(){this.Type=m.Type,this.Value="."}DisplayStr(){return this.Value}};let g=m;g.Type="Dot";const y=class{constructor(){this.Type=y.Type,this.Value="..."}DisplayStr(){return this.Value}};let w=y;w.Type="Dot3";const R=class{constructor(e){this.Type=R.Type,this.Value=e}DisplayStr(){return this.Value}};let V=R;V.Type="Comment";const x=class{constructor(){this.Type=x.Type}DisplayStr(){return this.Value.DisplayStr()}};let T=x;T.Type="Char";const v=class{constructor(e){this.Type=v.Type,this.Value=new s.A,this.Value.Value=e}DisplayStr(){return this.Value.DisplayStr()}};let S=v;S.Type="String";const b=class{constructor(e){this.Type=b.Type,this.Value=new a.d(e)}DisplayStr(){return this.Value.DisplayStr()}};let P=b;P.Type="Boolean";class E{constructor(){this.sign=1,this.value="",this.suffix=""}generate(e,t){if(0===this.value.length)return{r:n.xJ.MakeFromRational(n.uG.MakeFromInteger(0,1)),e:!0};let r=this.suffix.length>0?Number.parseInt(this.suffix):0;if(-1!==this.value.indexOf(".")){let t=this.sign*Number.parseFloat(this.value);return 1===e?{r:n.xJ.MakeFromFloat(!0,t),e:!0}:{r:n.xJ.MakeFromFloat(!1,t),e:!1}}if(-1!==this.value.indexOf("/")){let t=this.value.split("/"),r=Number.parseInt(t[0]),a=Number.parseInt(t[1]);return 2===e?{r:n.xJ.MakeFromFloat(!1,r/a),e:!1}:{r:n.xJ.MakeFromRational(n.uG.MakeFromInteger(r,a)),e:!0}}{let t=this.sign*Number.parseInt(this.value)*Math.pow(10,r);return 1===e?{r:n.xJ.MakeFromFloat(!0,t),e:!0}:2===e||r<0?{r:n.xJ.MakeFromFloat(!1,t),e:!1}:{r:n.xJ.MakeFromRational(n.uG.MakeFromInteger(t,1)),e:!0}}}}const k=class{constructor(){this.Type=k.Type,this.Radix=10,this.Exactness=0,this.Real=new E,this.UnReal=new E,this.Part=0}DisplayStr(){return this.Value.DisplayStr()}appendValue(e){0===this.Part?this.Real.value+=e:this.UnReal.value+=e}appendSuffix(e){0===this.Part?this.Real.suffix+=e:this.UnReal.suffix+=e}setSign(e){0===this.Part?this.Real.sign=e:this.UnReal.sign=e}generate(){let e=this.Real.generate(this.Exactness,this.Radix),t=this.UnReal.generate(this.Exactness,this.Radix),r=e.e&&t.e;this.Value=new n.Zz,this.Value.RealPart=n.xJ.MakeFromReal(r,e.r),this.Value.UnRealPart=n.xJ.MakeFromReal(r,t.r)}};let F=k;F.Type="Complex";class D{constructor(e){this.Type=S.Type,this.Value=new i.x(e)}DisplayStr(){return this.Value.Value}}D.Type="Identifier"}}]);